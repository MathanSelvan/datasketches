<!DOCTYPE html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="user-scalable = yes">
	<!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->

	<title>Figures in the Stars</title>
	<meta name="author" content="Nadieh Bremer">
	<meta name="description" content="Data Sketches - May - Myths & Legends - Nadieh">
	<meta name="keywords" content="data, visualization, visualisation, data visualization, data visualisation, information, information visualization, information visualisation, dataviz, datavis, infoviz, infovis, collaboration, data art">
	
	<!-- <meta property="og:title" content="Cardcaptor Sakura - Fifty chapters of adorable cuteness">
	<meta property="og:site_name" content="data sketch|es">
	<meta property="og:url" content="http://www.datasketch.es/june/code/nadieh">
	<meta property="og:description" content="Discover all of Cardcaptor Sakura and see why it's one of the most beautiful manga ever made">
	<meta property="og:type" content="article">
	<meta property="og:locale" content="en_US">
	<meta property="og:image" content="http://www.datasketch.es/june/code/nadieh/img/ccs_feature.jpg">
	<meta property="og:image:type" content="image/jpeg">
	<meta property="og:image:width" content="1920">
	<meta property="og:image:height" content="1080">
	
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:site" content="@datasketches">
	<meta name="twitter:creator" content="@NadiehBremer">
	<meta name="twitter:title" content="Cardcaptor Sakura - Fifty chapters of adorable cuteness">
	<meta name="twitter:description" content="Discover all of Cardcaptor Sakura and see why it's one of the most beautiful manga ever made">
	<meta name="twitter:image:src" content="http://www.datasketch.es/june/code/nadieh/img/ccs_feature.jpg"> -->

	<!-- JavaScript plugin files -->
    <!-- <script src="../../../plugins/d3.min.js"></script> -->
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="js/d3-contour.v1.min.js"></script>
	<!-- <script src="../../../plugins/lodash.min.js"></script> -->
	<script src="https://cdn.jsdelivr.net/npm/lodash@4.17.10/lodash.min.js"></script>
    <!-- <script src="../../../plugins/d3-annotation.min.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
    <script src="js/chroma.js"></script>
    
    <!-- Custom JavaScript files -->
    <script src="js/main.js"></script>
	<script src="js/createProjection.js"></script>
	<script src="js/drawDeepSpace.js"></script>
	<script src="js/drawConstellations.js"></script>
	<script src="js/drawStars.js"></script>

	<!-- Styling -->
    <link href="css/style.css" rel="stylesheet">
    
    <!-- Google fonts -->
    <!-- <link href="https://fonts.googleapis.com/css?family=Muli:300i,400|Poppins" rel="stylesheet"> -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:400" rel="stylesheet">

</head>

<body>

    <!-- Title -->
    <section id="header-section">
        <h1>STILL IN THE WORKS</h1>
    </section>

    <!-- Intro text -->
    <section id="intro-text">
        <p></p>
    </section>

    <!-- Orion Chart -->
    <section id="orion-chart-section">
        <!-- <h3>The star 'Betelgeuse' is used in constellations of at least 17 cultures</h3> -->
        <div id="chart-container-orion">
            <div id="chart-orion"></div>
        </div>        
    </section>

    <!-- Credits & Data -->
    <!-- <section id="credit-section">
        <p class="credit-bold">Created by
            <a href="https://twitter.com/NadiehBremer" target="_new">Nadieh Bremer</a>
            <span class="divider grey">|</span>
            <a href="http://www.visualcinnamon.com/" target="_new">Visual Cinnamon</a>
        </p>
        <p class="credit-note">Go to
            <a href="../..">datasketches' May month</a> to read about the data preparation, design, coding & more</p>
    </section> -->

    <script>

        ///////////////////////////////////////////////////////////////////////////
        ////////////////////////// Load zodiac images /////////////////////////////
        ///////////////////////////////////////////////////////////////////////////

        //Create zodiac base dataset
        let zodiac = {}
        zodiac[0] = {sign: "aries"}
        zodiac[30] = {sign: "taurus"}
        zodiac[60] = {sign: "gemini"}
        zodiac[90] = {sign: "cancer"}
        zodiac[120] = {sign: "leo"}
        zodiac[150] = {sign: "virgo"}
        zodiac[180] = {sign: "libra"}
        zodiac[210] = {sign: "scorpio"}
        zodiac[240] = {sign: "sagittarius"}
        zodiac[270] = {sign: "capricorn"}
        zodiac[300] = {sign: "aquarius"}
        zodiac[330] = {sign: "pisces"}

        for (let key in zodiac) {
            if (zodiac.hasOwnProperty(key)) {
                zodiac[key].img = new Image()
                zodiac[key].img.src = "img/" + zodiac[key].sign + ".png"
                zodiac[key].img.onload = onImgLoad
            }//if
        }//for key

        let num_img_loaded = 0
        const num_img = 12
        let img_loaded = false
        function onImgLoad() {
            num_img_loaded++
            if (num_img_loaded === num_img) {
                // console.log("imgs loaded")
                img_loaded = true
                checkAllLoaded()
            }//if
        }//function onImgLoad

        ///////////////////////////////////////////////////////////////////////////
        ////////////////////////////// Load fonts /////////////////////////////////
        ///////////////////////////////////////////////////////////////////////////

        let font_loaded = false
        // //Edge can't handle this
        // document.fonts.ready.then(() => {
        //     console.log("ready fonts")
        // })
        WebFont.load({
            google: {
                families: ['Glass Antiqua']
                // families: ['Cormorant:400,400i']
            },
            active: function () {
                // console.log("fonts loaded")
                font_loaded = true
                checkAllLoaded()
            }
        });

        ///////////////////////////////////////////////////////////////////////////
        /////////////////////////////// Load data /////////////////////////////////
        ///////////////////////////////////////////////////////////////////////////

        d3.queue() 
            .defer(d3.csv, "../../data/nadieh/stars.csv")
            .defer(d3.csv, "../../data/nadieh/constellation_links.csv")
            .defer(d3.csv, "../../data/nadieh/constellation_names.csv")
            .defer(d3.csv, "../../data/nadieh/constellations_per_star.csv")
            .await(dataLoaded)

        let data_loaded = false
        let stars, const_links, const_names, const_per_star
        let star_by_id = {}
        function dataLoaded() {
            //Put loaded data into the variables
            [error, stars, const_links, const_names, const_per_star] = [...arguments]
            if (error) throw error

            stars.forEach(d => {
                d.hip = +d.hip
                d.ra = +d.ra
                d.dec = +d.dec
                d.mag = +d.mag
                d.t_eff = +d.t_eff
            })//forEach

            const_links.forEach(d => {
                d.source = +d.source
                d.target = +d.target
            })//forEach

            const_per_star.forEach(d => {
                d.star_id = +d.star_id
            })//forEach

            stars.forEach(d => {
                star_by_id[d.hip] = d
            })//forEach

            // console.log("data loaded")
            data_loaded = true
            checkAllLoaded()
        }//function dataLoaded

        ///////////////////////////////////////////////////////////////////////////
        ///////////////////////// Run when all loaded /////////////////////////////
        ///////////////////////////////////////////////////////////////////////////

        function checkAllLoaded() {
            if(img_loaded && font_loaded && data_loaded) {
                // console.log("drawing")
                setupStarMaps(stars, star_by_id, const_links, const_names, const_per_star, zodiac)
            }//if
        }//function checkAllLoaded

    </script>
    
    <!-- Google analytics -->
	<!-- <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-43942889-3', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
    </script> -->

</body>

</html>